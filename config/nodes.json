{
  "node_groups": {
    "consul_cluster": {
      "consul-0": {
        ":base": "puppetlabs/centos-6.6-64-nocm",
        ":ip": "172.20.20.10",
        ":role": "consul_server",
        ":memory": 1024,
        ":cpus": 1,
        "ports": [
        ],
        "scripts": [
          "unzip /tmp/synced_folder/consul_0.7.1_linux_amd64.zip -d /tmp",
          "sudo mv /tmp/consul /usr/bin",
          "sudo mkdir /etc/consul.d",
          "sudo iptables -I INPUT 1 -p tcp --dport 8300 -j ACCEPT",
          "sudo iptables -I INPUT 1 -p tcp --dport 8301 -j ACCEPT",
          "sudo iptables -I INPUT 1 -p tcp --dport 8500 -j ACCEPT",
          "consul agent -server -bootstrap-expect=3 -data-dir=/tmp/consul -node=consul-0 -bind=172.20.20.10 -config-dir=/etc/consul.d -ui"
        ]
      },
      "consul-1": {
        ":base": "puppetlabs/centos-6.6-64-nocm",
        ":ip": "172.20.20.11",
        ":role": "consul_server",
        ":memory": 1024,
        ":cpus": 1,
        "ports": [
        ],
        "scripts": [
          "unzip /tmp/synced_folder/consul_0.7.1_linux_amd64.zip -d /tmp",
          "sudo mv /tmp/consul /usr/bin",
          "sudo mkdir /etc/consul.d",
          "sudo iptables -I INPUT 1 -p tcp --dport 8300 -j ACCEPT",
          "sudo iptables -I INPUT 1 -p tcp --dport 8301 -j ACCEPT",
          "sudo iptables -I INPUT 1 -p tcp --dport 8500 -j ACCEPT",
          "consul agent -server -bootstrap-expect=3 -data-dir=/tmp/consul -node=consul-1 -bind=172.20.20.11 -config-dir=/etc/consul.d -ui"
        ]
      },
      "consul-2": {
        ":base": "puppetlabs/centos-6.6-64-nocm",
        ":ip": "172.20.20.12",
        ":role": "consul_server",
        ":memory": 1024,
        ":cpus": 1,
        "ports": [
        ],
        "scripts": [
          "unzip /tmp/synced_folder/consul_0.7.1_linux_amd64.zip -d /tmp",
          "sudo mv /tmp/consul /usr/bin",
          "sudo mkdir /etc/consul.d",
          "sudo iptables -I INPUT 1 -p tcp --dport 8300 -j ACCEPT",
          "sudo iptables -I INPUT 1 -p tcp --dport 8301 -j ACCEPT",
          "sudo iptables -I INPUT 1 -p tcp --dport 8500 -j ACCEPT",
          "consul agent -server -bootstrap-expect=3 -data-dir=/tmp/consul -node=consul-2 -bind=172.20.20.12 -config-dir=/etc/consul.d -ui",
          "consul join 172.20.20.10 172.20.20.11"
        ]
      }
    }
  }
}
